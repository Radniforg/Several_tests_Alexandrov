1) за каждый день января 2021 года (по дате завершения заказа = finish_dt) вывести следующие данные:
client_payments -- сколько денег клиенты заплатили за заказы
revenue -- сколько денег осталось после всех выплат курьерам
AOR -- average order revenue (доход в расчете на выполненный заказ)
деньги считаем только за выполненные (completed) заказы

Логическое решение:
-Получить с таблицы все завершенные (completed) заказы для каждого дня finish_dt 2021-01-
-Получить с этих заказов данные об оплате заказчика (client_payments) и
 остаток после курьера (client_payments - (courier_payments + courier_bonus) из второй таблицы).
-Рассчитать среднее, вывести все три

Для теста нужно:
-1 заказ, законченный до 01.2021
-1 заказ, законченный после 01.2021
-1 заказ, отмененный 01.2021
-1 заказ, незавершенный 01.2021
-3 заказа, завершенных 01.2021.

2) сколько заказов в феврале 2021 года сделали клиенты, которые сделали свой первый заказ в январе?
заказы опять считаем только выполненные и по дате завершения

Комментарий: чисто задача на серф данных в БД

Логическое решение:
Вариант 1:
-Выбираем всех клиентов, которые сделали завершенные (completed) заказ в январе 2021 (по схожей схеме: finish_dt 2021-01-*)
 и феврале (finish_dt 2021-02-*)
-Исключаем тех, кто из этих клиентов делал заказ раньше 2021-01-* (нужно проверить, возможно ли это).
Вариант 2:
-Реверснуть. Сначала выделить всех клиентов,
кто не делал заказ раньше января, а потом среди этих клиентов поискать февральщиков.
# Решение подходит по определению задачи, но не подходит по
определению логики: нужно смотреть completed, но по create_dt для январе. Для февраля можно тоже оставить completed
с finish_dt, при этом сделать проверку, что это не один и тот же заказ.

Для теста нужно:
-1 заказ, сделанный до 01.2021
-1 заказ, сделанный и завершенный 02.2021 (от нового клиента)
-1 заказ, сделанный 01.2021, но не завершенный
-по заказу от 3 клиентов, сделавших заказ и 01.2021, и 02.2021
-1 заказ от клиента, сделавшего заказ 01.2021, но не сделавшего новый 02.2021.
-бонус: заказ сделан в январе, но завершен в феврале.

3) для каждого города по дням создания заказа вывести следующие метрики. для заказов созданных в январе 2021:
- кол-во созданных заказов
- % отмененных заказов
- кол-во активных клиентов (активный = тот кто создавал заказы)
- кол-во заказов выполненных в тот же день
- медианное время выполнения заказа (предполагаем, что запрос выполняется на последней версии postgresql/mysql/mariadb)

Комментарий:
-Кол-во заказов тупо по create_dt
-Кол-во заказов по create_dt + status=cancelled/Кол-во заказов по create_dt
-Кол-во уникальных client_id по create_dt
-Кол-во заказов по create_dt (дата) = finish_dt + status=completed
-Среднее между (finish_dt-create_dt).

Вопрос: нужен ли мне здесь timestamp и как с ним работать, если нужен? За исключением
последнего пункта везде требуется тупо дата.

Для теста нужно:
-5 заказов, сделанных и завершенных в январе
-2 отмененных заказа
-1 открытый заказ
-4 клиента на 8 заказов.

таблицы:

create table orders (
order_id int unsigned not null auto_increment,
city_id tinyint unsigned not null,
client_id int unsigned not null,
client_payment int unsigned not null,
created_dt datetime not null,
status enum('active', 'completed', 'cancelled') not null,
courier_id int unsigned default null,
courier_payment int unsigned default null,
finish_dt datetime default null,
primary key (order_id)
);

create table courier_bonuses (
date date not null,
courier_id int unsigned not null,
bonus_amount int unsigned not null,
primary key (date, courier_id)
);